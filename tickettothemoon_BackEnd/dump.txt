-- H2 2.1.214; 
;              
CREATE USER IF NOT EXISTS "VI" SALT '647aedecca562905' HASH 'ab984163028ee75f1e062cbc623500e19cd79ac6c499504d0127cb085c0066df' ADMIN;          
DROP TABLE IF EXISTS "PUBLIC"."flyway_schema_history" CASCADE; 
DROP TABLE IF EXISTS "PUBLIC"."BOOKABLE_SEAT" CASCADE;         
DROP TABLE IF EXISTS "PUBLIC"."CATEGORY_SPATIAL" CASCADE;      
DROP TABLE IF EXISTS "PUBLIC"."CATEGORY_TARIFF" CASCADE;       
DROP TABLE IF EXISTS "PUBLIC"."CLIENT" CASCADE;
DROP TABLE IF EXISTS "PUBLIC"."CONFIGURATION_HALL" CASCADE;    
DROP TABLE IF EXISTS "PUBLIC"."EVENT" CASCADE; 
DROP TABLE IF EXISTS "PUBLIC"."EVENT_ORDER" CASCADE;           
DROP TABLE IF EXISTS "PUBLIC"."HALL" CASCADE;  
DROP TABLE IF EXISTS "PUBLIC"."SEAT" CASCADE;  
DROP TABLE IF EXISTS "PUBLIC"."SESSION_EVENT" CASCADE;         
DROP TABLE IF EXISTS "PUBLIC"."VENUE" CASCADE; 
DROP SEQUENCE IF EXISTS "PUBLIC"."BOOKABLE_SEAT_SEQ";          
CREATE SEQUENCE "PUBLIC"."BOOKABLE_SEAT_SEQ" START WITH 1 INCREMENT BY 50;     
DROP SEQUENCE IF EXISTS "PUBLIC"."CATEGORY_TARIFF_SEQ";        
CREATE SEQUENCE "PUBLIC"."CATEGORY_TARIFF_SEQ" START WITH 1 INCREMENT BY 50;   
DROP SEQUENCE IF EXISTS "PUBLIC"."CLIENT_SEQ"; 
CREATE SEQUENCE "PUBLIC"."CLIENT_SEQ" START WITH 1 RESTART WITH 51 INCREMENT BY 50;            
DROP SEQUENCE IF EXISTS "PUBLIC"."CONFIGURATION_HALL_SEQ";     
CREATE SEQUENCE "PUBLIC"."CONFIGURATION_HALL_SEQ" START WITH 1 RESTART WITH 51 INCREMENT BY 50;
DROP SEQUENCE IF EXISTS "PUBLIC"."EVENT_ORDER_SEQ";            
CREATE SEQUENCE "PUBLIC"."EVENT_ORDER_SEQ" START WITH 1 INCREMENT BY 50;       
DROP SEQUENCE IF EXISTS "PUBLIC"."SESSION_EVENT_SEQ";          
CREATE SEQUENCE "PUBLIC"."SESSION_EVENT_SEQ" START WITH 1 RESTART WITH 51 INCREMENT BY 50;     
CREATE MEMORY TABLE "PUBLIC"."flyway_schema_history"(
    "installed_rank" INTEGER NOT NULL,
    "version" CHARACTER VARYING(50),
    "description" CHARACTER VARYING(200) NOT NULL,
    "type" CHARACTER VARYING(20) NOT NULL,
    "script" CHARACTER VARYING(1000) NOT NULL,
    "checksum" INTEGER,
    "installed_by" CHARACTER VARYING(100) NOT NULL,
    "installed_on" TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,
    "execution_time" INTEGER NOT NULL,
    "success" BOOLEAN NOT NULL
);           
ALTER TABLE "PUBLIC"."flyway_schema_history" ADD CONSTRAINT "PUBLIC"."flyway_schema_history_pk" PRIMARY KEY("installed_rank"); 
-- 1 +/- SELECT COUNT(*) FROM PUBLIC.flyway_schema_history;    
CREATE INDEX "PUBLIC"."flyway_schema_history_s_idx" ON "PUBLIC"."flyway_schema_history"("success" NULLS FIRST);
CREATE MEMORY TABLE "PUBLIC"."BOOKABLE_SEAT"(
    "ID" BIGINT NOT NULL,
    "NAME" CHARACTER VARYING(255),
    "PRICE" FLOAT(53) NOT NULL,
    "TAXES" FLOAT(53) NOT NULL,
    "EVENT_ORDER_FK" BIGINT,
    "SEAT" BIGINT,
    "SESSION_EVENTS_FK" BIGINT
);   
ALTER TABLE "PUBLIC"."BOOKABLE_SEAT" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_F" PRIMARY KEY("ID"); 
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.BOOKABLE_SEAT;            
CREATE MEMORY TABLE "PUBLIC"."CATEGORY_SPATIAL"(
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1 RESTART WITH 2) NOT NULL,
    "NAME" CHARACTER VARYING(255)
);  
ALTER TABLE "PUBLIC"."CATEGORY_SPATIAL" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_5" PRIMARY KEY("ID");              
-- 1 +/- SELECT COUNT(*) FROM PUBLIC.CATEGORY_SPATIAL;         
CREATE MEMORY TABLE "PUBLIC"."CATEGORY_TARIFF"(
    "ID" BIGINT NOT NULL,
    "NAME" CHARACTER VARYING(255),
    "REMAINING_CAPACITY" INTEGER NOT NULL,
    "CONFIGURATION_HALL_FK" BIGINT
);  
ALTER TABLE "PUBLIC"."CATEGORY_TARIFF" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_B" PRIMARY KEY("ID");               
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.CATEGORY_TARIFF;          
CREATE MEMORY TABLE "PUBLIC"."CLIENT"(
    "ID" BIGINT NOT NULL,
    "CITY" CHARACTER VARYING(255),
    "COUNTRY" CHARACTER VARYING(255),
    "STREET" CHARACTER VARYING(255),
    "ZIPCODE" CHARACTER VARYING(255),
    "CREDIT_CARD_NUMBER" INTEGER NOT NULL,
    "EMAIL" CHARACTER VARYING(255),
    "FIRST_NAME" CHARACTER VARYING(255),
    "LAST_NAME" CHARACTER VARYING(255),
    "PHONE_NUMBER" CHARACTER VARYING(255),
    "USERNAME" CHARACTER VARYING(255)
);       
ALTER TABLE "PUBLIC"."CLIENT" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_7" PRIMARY KEY("ID");        
-- 1 +/- SELECT COUNT(*) FROM PUBLIC.CLIENT;   
CREATE MEMORY TABLE "PUBLIC"."CONFIGURATION_HALL"(
    "ID" BIGINT NOT NULL,
    "CONFIGURATION_CAPACITY" INTEGER NOT NULL,
    "NAME" CHARACTER VARYING(255),
    "HALL_FK" BIGINT
);         
ALTER TABLE "PUBLIC"."CONFIGURATION_HALL" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_9" PRIMARY KEY("ID");            
-- 1 +/- SELECT COUNT(*) FROM PUBLIC.CONFIGURATION_HALL;       
CREATE MEMORY TABLE "PUBLIC"."EVENT"(
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1 RESTART WITH 2) NOT NULL,
    "CLOSED_DAY" CHARACTER VARYING(255),
    "DATE_END" DATE,
    "DATE_START" DATE,
    "NAME" CHARACTER VARYING(255),
    "CONFIGURATION_HALL_FK" BIGINT
);    
ALTER TABLE "PUBLIC"."EVENT" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_3" PRIMARY KEY("ID");         
-- 1 +/- SELECT COUNT(*) FROM PUBLIC.EVENT;    
CREATE MEMORY TABLE "PUBLIC"."EVENT_ORDER"(
    "ID" BIGINT NOT NULL,
    "DATE_ORDER" DATE,
    "DATE_SESSION_EVENT" DATE,
    "FEES" INTEGER NOT NULL,
    "IS_PAID" BOOLEAN NOT NULL,
    "TOTALHT" FLOAT(53) NOT NULL,
    "TOTALTTC" FLOAT(53) NOT NULL,
    "CLIENT_FK" BIGINT
);        
ALTER TABLE "PUBLIC"."EVENT_ORDER" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_D" PRIMARY KEY("ID");   
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.EVENT_ORDER;              
CREATE MEMORY TABLE "PUBLIC"."HALL"(
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1 RESTART WITH 2) NOT NULL,
    "CAPACITY" INTEGER NOT NULL,
    "NAME" CHARACTER VARYING(255),
    "VENUE_FK" BIGINT
);      
ALTER TABLE "PUBLIC"."HALL" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_2" PRIMARY KEY("ID");          
-- 1 +/- SELECT COUNT(*) FROM PUBLIC.HALL;     
CREATE MEMORY TABLE "PUBLIC"."SEAT"(
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "NUMBER" INTEGER NOT NULL,
    "RESERVED" BOOLEAN NOT NULL,
    "ROW_SEAT" INTEGER NOT NULL,
    "SEATED" BOOLEAN NOT NULL,
    "AREA_FK" BIGINT,
    "CATEGORY_FK" BIGINT
);
ALTER TABLE "PUBLIC"."SEAT" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_26" PRIMARY KEY("ID");         
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.SEAT;     
CREATE MEMORY TABLE "PUBLIC"."SESSION_EVENT"(
    "ID" BIGINT NOT NULL,
    "DATE_HOUR_END_SESSION_EVENT" TIMESTAMP(6),
    "DATE_HOUR_START_SESSION_EVENT" TIMESTAMP(6),
    "DURATION_IN_MINUTES" INTEGER NOT NULL,
    "EVENT_FK" BIGINT
); 
ALTER TABLE "PUBLIC"."SESSION_EVENT" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_FB" PRIMARY KEY("ID");
-- 1 +/- SELECT COUNT(*) FROM PUBLIC.SESSION_EVENT;            
CREATE MEMORY TABLE "PUBLIC"."VENUE"(
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1 RESTART WITH 2) NOT NULL,
    "CITY" CHARACTER VARYING(255),
    "COUNTRY" CHARACTER VARYING(255),
    "STREET" CHARACTER VARYING(255),
    "ZIPCODE" CHARACTER VARYING(255),
    "CONTACT" CHARACTER VARYING(255),
    "MAIL" CHARACTER VARYING(255),
    "NAME" CHARACTER VARYING(255) NOT NULL
);       
ALTER TABLE "PUBLIC"."VENUE" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_4" PRIMARY KEY("ID");         
-- 1 +/- SELECT COUNT(*) FROM PUBLIC.VENUE;    
ALTER TABLE "PUBLIC"."SESSION_EVENT" ADD CONSTRAINT "PUBLIC"."FKGOVXY4CFT2JDVQOJV2K9MIET4" FOREIGN KEY("EVENT_FK") REFERENCES "PUBLIC"."EVENT"("ID") NOCHECK;  
ALTER TABLE "PUBLIC"."SEAT" ADD CONSTRAINT "PUBLIC"."FKTFKRAIGTOG9CBO86E10DSIBVU" FOREIGN KEY("CATEGORY_FK") REFERENCES "PUBLIC"."CATEGORY_SPATIAL"("ID") NOCHECK;             
ALTER TABLE "PUBLIC"."EVENT" ADD CONSTRAINT "PUBLIC"."FK63UP83HN2UGCWOYJJ6XBE2VDK" FOREIGN KEY("CONFIGURATION_HALL_FK") REFERENCES "PUBLIC"."CONFIGURATION_HALL"("ID") NOCHECK;
ALTER TABLE "PUBLIC"."HALL" ADD CONSTRAINT "PUBLIC"."FKN59VGUK8D46MGHVJB86DA7EI8" FOREIGN KEY("VENUE_FK") REFERENCES "PUBLIC"."VENUE"("ID") NOCHECK;           
ALTER TABLE "PUBLIC"."SEAT" ADD CONSTRAINT "PUBLIC"."FKELEHHJICQJIKRGTJ1677A529R" FOREIGN KEY("AREA_FK") REFERENCES "PUBLIC"."CATEGORY_TARIFF"("ID") NOCHECK;  
ALTER TABLE "PUBLIC"."BOOKABLE_SEAT" ADD CONSTRAINT "PUBLIC"."FK8R3JFRTTJ56AJ9Q85KPU6CFMQ" FOREIGN KEY("SEAT") REFERENCES "PUBLIC"."SEAT"("ID") NOCHECK;       
ALTER TABLE "PUBLIC"."CONFIGURATION_HALL" ADD CONSTRAINT "PUBLIC"."FK30PXI0YTIEY7U8YJK001XUMYX" FOREIGN KEY("HALL_FK") REFERENCES "PUBLIC"."HALL"("ID") NOCHECK;               
ALTER TABLE "PUBLIC"."CATEGORY_TARIFF" ADD CONSTRAINT "PUBLIC"."FKSKDKOLBRF2NRGLXB1LV9KPGUO" FOREIGN KEY("CONFIGURATION_HALL_FK") REFERENCES "PUBLIC"."CONFIGURATION_HALL"("ID") NOCHECK;      
ALTER TABLE "PUBLIC"."BOOKABLE_SEAT" ADD CONSTRAINT "PUBLIC"."FK3GXY28P94AGBCUMHLVETCJ4YX" FOREIGN KEY("SESSION_EVENTS_FK") REFERENCES "PUBLIC"."SESSION_EVENT"("ID") NOCHECK; 
ALTER TABLE "PUBLIC"."BOOKABLE_SEAT" ADD CONSTRAINT "PUBLIC"."FKSXOTN7PRA9ONOHYA0T822JM8G" FOREIGN KEY("EVENT_ORDER_FK") REFERENCES "PUBLIC"."EVENT_ORDER"("ID") NOCHECK;      
ALTER TABLE "PUBLIC"."EVENT_ORDER" ADD CONSTRAINT "PUBLIC"."FKAB9VMN0P4SMWFMD1IUO2U83EH" FOREIGN KEY("CLIENT_FK") REFERENCES "PUBLIC"."CLIENT"("ID") NOCHECK;  
